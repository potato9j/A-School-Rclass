## 16-1 ğŸŸ¦ dplyr íŒ¨í‚¤ì§€ í•¨ìˆ˜ (p.223)

ê¸°í˜¸ | ì‚¬ìš©ë²• | ì˜ë¯¸  
:---: | --- | --- 
filter() | filter(ë°ì´í„°, ì¡°ê±´) | ì¡°ê±´ì— ë§ëŠ” í–‰ì„ ì¶œë ¥í•œë‹¤.
select() | select(ë°ì´í„°, ì¡°ê±´) |ì¡°ê±´ì— ë§ëŠ” ì—´ì„ ì¶œë ¥í•œë‹¤.
arrange() | - |ë°ì´í„°ë¥¼ ì •ë°©í–¥ìœ¼ë¡œ ì •ë ¬í•œë‹¤.
desc() | - | ë°ì´í„°ë¥¼ ì—­ë°©í–¥ìœ¼ë¡œ ì •ë ¬í•œë‹¤.
mutate() | mutate(ë°ì´í„°, ìƒˆë³€ìˆ˜ëª… = ìƒˆë³€ìˆ˜ìƒì„±ê·œì¹™) |ìƒˆë¡œìš´ ë³€ìˆ˜ ìƒì„±
summarise() | summarise(ìš”ì•½ë³€ìˆ˜ëª…1 = ìš”ì•½í•¨ìˆ˜1, ìš”ì•½ë³€ìˆ˜ëª…2 = ìš”ì•½í•¨ìˆ˜2, ...) | ë¶„í• ëœ ë°ì´í„°ë¥¼ ìš”ì•½í•˜ê³  ë‹¤ì‹œ í•©ì¹¨
group_by() | group_by(ë³€ìˆ˜ëª…1, ë³€ìˆ˜ëª…2, ...) | ë°ì´í„°ë¥¼ ì§‘ë‹¨ë³„ë¡œ ë‚˜ëˆ”
%>% | - | (ëª…ì¹­ : íŒŒì´í”„) ì´ì „ í•¨ìˆ˜ì— ì´ì–´ ë‹¤ìŒ í•¨ìˆ˜ê¹Œì§€ ì‹¤í–‰

<br>
<br>

------------------------------------------------------------------------------------------ 

## 16-1-1 ğŸŸ¦ summarise() ìš”ì•½ í†µê³„ëŸ‰ í•¨ìˆ˜ (p.236)

ê¸°í˜¸ | ì˜ë¯¸  
:---: | --- 
mean() | í‰ê· 
median() | ì¤‘ì•™ê°’
sd() | í‘œì¤€í¸ì(Standard Deviation)
min() | ìµœì†Ÿê°’
max() | ìµœëŒ“ê°’
IQR() | ì‚¬ë¶„ìœ„ìˆ˜(Inter Quartile Range)
sum() | í•©
n() | ë¹ˆë„(ì‚¬ë¡€ ìˆ˜ ì„¸ëŠ” í•¨ìˆ˜)
n_distinict() | ì¤‘ë³µ ì œê±° í›„ ì‚¬ë¡€ ìˆ˜

<br>
<br>

------------------------------------------------------------------------------------------ 

## 16-1-2 ğŸŸ¦ dplyr íŒ¨í‚¤ì§€ ì˜ˆì‹œ

<br>

```
   > iris
   > str(iris) #ë°ì´í„° êµ¬ì¡°ë³´ê¸°
   > View(iris)
   > table(iris$Species) #ë²”ì£¼ë³„ ë¹ˆë„

   > library(dplyr)
```
<br>

### **âœ…10/31 ìˆ˜ì—…**

```
ğŸ”¸ filter í•¨ìˆ˜ : filter(ë°ì´í„°, ì¡°ê±´), í–‰ì„ ì¶”ì¶œ
   

ğŸ”¹ì˜ˆì œ1
  Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì¸ ê²½ìš°ë§Œ ì¶”ì¶œ

   > filter(iris, Species == "setosa")  

   > iris %>%
      filter(Species == "setosa")
__________________________________________________________________________________________ 

ğŸ”¹ì˜ˆì œ2
   Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì´ê³  Sepal.Widthê°€ 3ì´ìƒì¸ ë°ì´í„° ì¶”ì¶œ
     
   > iris %>%
      filter(Species == "setosa" & Sepal.Width >= 3)
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ3
   Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì´ê³  Sepal.Widthê°€ 3ì´ìƒì¸ ë°ì´í„° ì¤‘ì— 
   Sepal.Widthì™€ Sepal.Lengthë¥¼ ì¶”ì¶œ
   
   > iris %>%
      filter(Species == "setosa" & Sepal.Width >= 3) %>%
      select(Sepal.Width, Sepal.Length)
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ4
   Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì´ê³  Sepal.Widthê°€ 3ì´ìƒì¸ ë°ì´í„° ì¤‘ì— 
   Sepal.Widthì™€ Sepal.Lengthë¥¼ ì¶”ì¶œí•˜ê³ 
   Sepal.Widthì˜ ë‚´ë¦¼ì°¨ìˆœ, Sepal.LengthëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬   
   
   > iris %>%
      filter(Species == "setosa" & Sepal.Width >= 3) %>%
      select(Sepal.Width, Sepal.Length) %>%
      arrange(desc(Sepal.Width), Sepal.Length)

```      


```
ğŸ”¸ mutate() : ìƒˆë¡œìš´ ë³€ìˆ˜ ìƒì„±
ğŸ”¸ mutate(ë°ì´í„°, ìƒˆë³€ìˆ˜ëª… = ìƒˆë³€ìˆ˜ìƒì„±ê·œì¹™)
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ1
   Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì´ê³  Sepal.Widthê°€ 3ì´ìƒì¸ ë°ì´í„° ì¤‘ì— 
   Sepal.Widthì™€ Sepal.Lengthë¥¼ ì¶”ì¶œí•˜ê³  
   Sepal.Widthì˜ ë‚´ë¦¼ì°¨ìˆœ, Sepal.LengthëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³  
   Sepal.Widthì™€ Sepal.Lengthì˜ í•©ì„ Sepalì´ë¼ëŠ” ë³€ìˆ˜ë¡œ ì €ì¥
   
   > iris %>%
      filter(Species == "setosa" & Sepal.Width >= 3) %>%
      select(Sepal.Width, Sepal.Length) %>%
      arrange(desc(Sepal.Width), Sepal.Length) %>%
      mutate(Sepal = Sepal.Width+Sepal.Length)
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ2
   Species ë¼ëŠ” ë³€ìˆ˜ê°€ "setosa"ì´ê³  Sepal.Widthê°€ 3ì´ìƒì¸ ë°ì´í„° ì¤‘ì— 
   Sepal.Widthì™€ Sepal.Lengthë¥¼ ì¶”ì¶œí•˜ê³  
   Sepal.Widthì˜ ë‚´ë¦¼ì°¨ìˆœ, Sepal.LengthëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³  
   Sepal.Widthì™€ Sepal.Lengthì˜ í•©ì„ Sepalì´ë¼ëŠ” ë³€ìˆ˜ë¡œ ì €ì¥, 
   mean_Septal.Length ë³€ìˆ˜ì— Sepal.Lengthì˜ í‰ê· ì„ ì €ì¥

   > iris %>%
      filter(Species == "setosa" & Sepal.Width >= 3) %>%
      select(Sepal.Width, Sepal.Length) %>%
      arrange(desc(Sepal.Width), Sepal.Length) %>%
      mutate(Sepal = Sepal.Width+Sepal.Length) %>%
      mutate(mean_Septal.Length = mean(Sepal.Length))
```


```
ğŸ”¸ group_by() : ë°ì´í„°ë¥¼ ë¶„í• 
ğŸ”¸ group_by(ë³€ìˆ˜ëª…1, ë³€ìˆ˜ëª…2, ...) : ë³€ìˆ˜ì˜ ê°’ ì¢…ë¥˜ì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„í• 

ğŸ”¸ summarise() : ë¶„í• ëœ ë°ì´í„°ë¥¼ ìš”ì•½í•˜ê³  ë‹¤ì‹œ í•©ì¹¨
ğŸ”¸ summarise(ìš”ì•½ë³€ìˆ˜ëª…1 = ìš”ì•½í•¨ìˆ˜1, ìš”ì•½ë³€ìˆ˜ëª…2 = ìš”ì•½í•¨ìˆ˜2, ...)
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ1
   iris ë°ì´í„°ì—ì„œ Species ë²”ì£¼ë³„ë¡œ Sepal.Lengthì˜ í‰ê· , 
   Sepal.Widthì˜ ìµœëŒ€ê°’, Petal.Lengthì˜ ìµœì†Œê°’, Petal.Widthì˜ ì‚¬ë¡€ ìˆ˜

   > iris %>%
      group_by(Species) %>%
      summarise(mean_Sepal.Length = mean(Sepal.Length), 
                max_Sepal.Width = max(Sepal.Width), 
                min_Petal.Length = min(Petal.Length), 
                num_Petal.Width = n()) # summariseì˜ n()í•¨ìˆ˜ëŠ” ì‚¬ë¡€ ìˆ˜ ê³„ì‚°í•¨ìˆ˜

```


```
ğŸ”¹gapminder packageë¥¼ ì„¤ì¹˜ í›„ ë¶ˆëŸ¬ì˜¤ê³ , gapminder ë°ì´í„°ì˜ êµ¬ì¡°ë³´ê¸°
 
   > install.packages('gapminder')
   > library(gapminder)
   > library(dplyr)
   > str(gapminder)
__________________________________________________________________________________________

ğŸ”¹ì—°ìŠµë¬¸ì œ1
   na.omit() í•¨ìˆ˜ë¡œ ê²°ì¸¡ì„ ì œê±°í•˜ê³  
   ì•„í”„ë¦¬ì¹´ ëŒ€ë¥™ì— ìˆëŠ” êµ­ê°€ë³„ lifeExpì˜ í‰ê· , lifeExpì˜ ìµœëŒ€, popì˜ í•©ì„ êµ¬í•œ ë’¤ 
   countryì´ë¦„ì˜ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬

   > na.omit(gapminder) %>%
       filter(continent == "Africa") %>%
       group_by(country) %>%
       summarise(mean_lifeExp=mean(lifeExp), 
                 max_lifeExp=max(lifeExp),
                 sum_pop=sum(pop)) %>%
       arrange(country)
__________________________________________________________________________________________

ğŸ”¹ì—°ìŠµë¬¸ì œ2
   airquality ë°ì´í„° ì…‹ì„ ì´ìš©í•´ì„œ ê²°ì¸¡ì„ ì œê±°í•˜ê³ 
   Month ë³„ë¡œ Ozoneì˜ í‰ê· , Solar.Rì˜ ìµœëŒ€ê°’, Windì˜ ì¤‘ì•™ê°’(ì¤‘ìœ„ìˆ˜)ë¥¼ ê³„ì‚°í•˜ê³  
   Month ì˜ ì˜¤ë¦„ì°¨ìˆœ, Ozoneì˜ í‰ê· ì˜ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬

   > na.omit(airquality) %>%
       group_by(Month) %>%
       summarise(mean_Ozone=mean(Ozone), 
                 max_Solar.R=max(Solar.R),
                 median_Wind=median(Wind)) %>%
       arrange(Month, desc(mean_Ozone))
```
<br>

### **âœ…11/3 ìˆ˜ì—…**
```
ğŸ”¹ë°ì´í„° íŒŒì¼ ì½ê¸°
   > mtcars # ë‚´ì¥ ë°ì´í„°(Rì´ ê°€ì§€ê³  ìˆëŠ” ë°ì´í„°)
   > str(mtcars) # ë°ì´í„° êµ¬ì¡° ë³´ê¸°ê¸°
   > View(mtcars) # í‘œ í˜•íƒœë¡œ ë³´ê¸°

   > install.packages('dplyr') # íŒ¨í‚¤ì§€ ì„¤ì¹˜
   > library(dplyr) # íŒ¨í‚¤ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ1
   í‰ê·  ì—°ë¹„ ì´ìƒì€ 'ê³ ì—°ë¹„', ë‚˜ë¨¸ì§€ëŠ” 'ì €ì—°ë¹„' ë¡œ ì €ì¥í•˜ëŠ” 'ì—°ë¹„'ë¼ëŠ” ë³€ìˆ˜ìƒì„±
   
   ë°©ë²•1))
   > ifelse(mtcars$mpg >= mean(mtcars$mpg), 'ê³ ì—°ë¹„', 'ì €ì—°ë¹„')

   ë°©ë²•2))
   > mtcars %>% 
       mutate(ì—°ë¹„=ifelse(mpg >= mean(mpg), 'ê³ ì—°ë¹„', 'ì €ì—°ë¹„'))
__________________________________________________________________________________________

ğŸ”¹ì˜ˆì œ2
   í‰ê·  ì—°ë¹„ ì´ìƒì€ 'ê³ ì—°ë¹„', ë‚˜ë¨¸ì§€ëŠ” 'ì €ì—°ë¹„' ë¡œ ì €ì¥í•˜ëŠ” 'ì—°ë¹„'ë¼ëŠ”
   ë³€ìˆ˜ìƒì„±í•˜ê³  ì—°ë¹„ì— ë”°ë¥¸(ì—°ë¹„ì¢…ë¥˜ ë³„ë¡œ) cylì˜ í‰ê· , ìµœëŒ€, ìµœì†Œë¥¼ ìš”ì•½

   > mtcars %>% 
       mutate(ì—°ë¹„=ifelse(mpg >= mean(mpg), 'ê³ ì—°ë¹„', 'ì €ì—°ë¹„')) %>%
       group_by(ì—°ë¹„) %>%
       summarise(í‰ê· cyl = mean(cyl), 
                 ìµœëŒ€cyl = max(cyl),
                 ìµœì†Œcyl = min(cyl))
```
<br>

### **âœ…11/7 ìˆ˜ì—…**
```
   > enrollment <- read.csv("c:/data/enrollment.csv")
   > library(dplyr)

   > str(enrollment)  # ë°ì´í„°êµ¬ì¡°ë³´ê¸°
   > View(enrollment)  # í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ íŒŒì¼ ë³´ê¸°
   > summary(enrollment)  # íŒŒì¼ ë‚´ìš© ìš”ì•½
__________________________________________________________________________________________

ğŸ”¹ì·¨ë“í•™ì ì— ë”°ë¥¸ ì ìˆ˜ ê³„ì‚° (A+ => 4.5)
   > ifelse(enrollment$ì„±ì  == 'A+', 4.5, 
            ifelse(enrollment$ì„±ì  == 'Ao', 4.0, 
                   ifelse(enrollment$ì„±ì  == 'B+', 3.5,
                          ifelse(enrollment$ì„±ì  == 'Bo', 3.0,
                                 ifelse(enrollment$ì„±ì  == 'C+', 2.5,
                                        ifelse(enrollment$ì„±ì  =='Co', 2.0, 0))))))
__________________________________________________________________________________________

ğŸ”¹dplyrë¥¼ í†µí•œ ë³€ìˆ˜ìƒì„±

   > enrollment %>%
       mutate(ì„±ì ì ìˆ˜ = ifelse(ì„±ì  == 'A+', 4.5, 
                         ifelse(ì„±ì  == 'Ao', 4.0, 
                         ifelse(ì„±ì  == 'B+', 3.5,
                         ifelse(ì„±ì  == 'Bo', 3.0,
                         ifelse(ì„±ì  == 'C+', 2.5,
                         ifelse(ì„±ì  == 'Co', 2.0, 0))))))) %>%
       mutate(í•™ì ìˆ˜Xì„±ì ì ìˆ˜ = í•™ì ìˆ˜*ì„±ì ì ìˆ˜) %>%
       group_by(í•™ë²ˆ ) %>%
       summarise(ì„±ì ì ìˆ˜í•© = sum(í•™ì ìˆ˜Xì„±ì ì ìˆ˜),
                 í•™ì ìˆ˜í•© = sum(í•™ì ìˆ˜)) %>%
       mutate(GPA = ì„±ì ì ìˆ˜í•©/í•™ì ìˆ˜í•©) %>%
       select(í•™ë²ˆ, GPA) %>% 
       merge(enrollment, by='í•™ë²ˆ', all.x=TRUE) %>%
       select(í•™ë²ˆ, GPA, ì†Œì†í•™ê³¼, í•™ë…„) %>%
       write.csv("C:/data/GPA.csv")
  ```
